# 資料集橫向比對分析工具

一個協助使用者比對不同資料集的工具，能以「樣本為核心」橫向比較不同資料集的結果，提升錯誤分析與 prompt 調整效率。

## 功能特色

- **多檔案上傳**：支援多個 JSON 格式的模型輸出上傳，根據檔名識別不同策略
- **統一資料合併**：根據 `sentence` 自動合併不同策略的結果進行對比
- **自動答對判斷**：比較 `output.answer` 與 `label`，自動標註每個策略是否答對
- **互動式錯誤分析**：表格支援排序、篩選、錯誤統計等互動功能
- **詳細比對視圖**：查看單筆資料在各策略下的完整 prompt、reasoning、response 
- **評論與標籤**：為樣本添加評論與自訂標籤，便於分析與後續檢討
- **策略交集分析**：分析不同策略間的錯誤重疊，找出共通或獨有的弱點
- **資料匯出**：將完整分析結果（含評論與標籤）匯出為 JSON 或 CSV 格式

## 安裝說明

1. 確保已安裝 Python 3.8 以上版本
2. 安裝所需套件：
   ```
   pip install -r requirements.txt
   ```

## 使用方法

1. 啟動應用：
   ```
   streamlit run app.py
   ```

2. 在瀏覽器中開啟顯示的 URL (通常是 http://localhost:8501)

3. 上傳 JSON 格式的策略結果檔案（每個檔案代表一種策略）

4. 使用介面上的各種工具進行分析：
   - 使用篩選器和排序選項找出關注的樣本
   - 點選樣本查看詳細資訊
   - 添加評論與標籤
   - 查看錯誤熱點圖和策略交集分析
   - 匯出完整分析結果

## 輸入資料格式

每個 JSON 檔案應包含多筆資料，每筆資料格式如下：

```json
{
  "input": "...",          // 策略的 prompt 字串
  "label": "gao1",         // 正確答案 (ground truth)
  "sentence": "相同句子",   // 用於聚合的唯一識別字串
  "output": {
    "answer": "gao1",      // 模型預測答案
    "reasoning": "...",    // 推理過程 (選填)
    "response": "..."      // 完整回應 (選填)
  }
}
```

## 注意事項

- 不同策略的檔案中，相同 `sentence` 的樣本必須具有相同的 `label`
- 檔案名稱將作為策略名稱顯示在分析介面上
- 使用者的評論和標籤僅在當前會話中保存，匯出後才會永久儲存 